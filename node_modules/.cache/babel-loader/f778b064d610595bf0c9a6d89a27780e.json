{"ast":null,"code":"import _objectSpread from\"/Users/phil/Documents/elevation-profile/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/phil/Documents/elevation-profile/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/phil/Documents/elevation-profile/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/phil/Documents/elevation-profile/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/phil/Documents/elevation-profile/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  transition: all 1.5s ease-in-out;\\n  /* transition: transform 300ms ease-in-out; */\\n\"]);_templateObject=function _templateObject(){return data;};return data;}/* eslint-disable react/prop-types */import React,{useState}from'react';import{connect}from'react-redux';import ReactMapGL,{Layer,NavigationControl,Source}from'react-map-gl';import update from'immutability-helper';import styled from'styled-components';import Markers from'./Markers';import{pushPinAction,setPinsAction}from'../store/actions/mapActions';import'mapbox-gl/dist/mapbox-gl.css';var MAPBOX_TOKEN=process.env.REACT_APP_MAPBOX_API_KEY;var mapStyle='mapbox://styles/pgres54268/cjuiu9aay60dx1fp784rt3x7r';var StyledMap=styled.div(_templateObject());var MapboxContainer=function MapboxContainer(_ref){var mapHeight=_ref.mapHeight,pins=_ref.pins,actions=_ref.actions;var hasPins=pins.length>0;var pushPin=actions.pushPin,setPins=actions.setPins;var _useState=useState({height:mapHeight,width:'100vw',position:'absolute',longitude:-119,latitude:36,zoom:5}),_useState2=_slicedToArray(_useState,2),viewport=_useState2[0],setViewport=_useState2[1];var onMapClick=function onMapClick(e){e.preventDefault();pushPin(e.lngLat);};var onMarkerDragEnd=function onMarkerDragEnd(e,index){e.preventDefault();var newPins=update(pins,_defineProperty({},index,{$set:_toConsumableArray(e.lngLat)}));setPins(newPins);};var onViewportChange=function onViewportChange(nextViewport){if(viewport.longitude*nextViewport.longitude<0){// TODO:\n// We are moving across the antimeridian and need to\n//   re-plot any pins near it\n// const newPins = replotPinsNearAntimeridian(pins);\n// console.log(pins, newPins);\n// setPins(newPins);\n}setViewport(_objectSpread({},nextViewport,{width:'100vw'}));};var linestringGeoJSON={type:'LineString',coordinates:_toConsumableArray(pins)};return React.createElement(StyledMap,null,React.createElement(ReactMapGL,Object.assign({mapboxApiAccessToken:MAPBOX_TOKEN,mapStyle:mapStyle,onViewportChange:onViewportChange// onLoad={() => setLoaded(true)}\n,onClick:function onClick(e){return onMapClick(e);}// eslint-disable-next-line react/jsx-props-no-spreading\n},viewport,{height:mapHeight}),hasPins&&React.createElement(React.Fragment,null,React.createElement(Markers,{pins:pins,onMarkerDragEnd:onMarkerDragEnd}),React.createElement(Source,{id:\"my-lines\",type:\"geojson\",data:linestringGeoJSON},React.createElement(Layer,{id:\"lines\",type:\"line\",paint:{'line-color':'#ff0000','line-width':2}}))),React.createElement(\"div\",{style:{position:'absolute',right:0}},React.createElement(NavigationControl,null))));};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{actions:{pushPin:function pushPin(pin){return dispatch(pushPinAction(pin));},setPins:function setPins(pins){return dispatch(setPinsAction(pins));}}};};var mapStateToProps=function mapStateToProps(state){return{submitting:state.chart.submitting,pins:state.map.pins// mapHeight: state.mapHeight,\n};};export default connect(mapStateToProps,mapDispatchToProps)(MapboxContainer);","map":{"version":3,"sources":["/Users/phil/Documents/elevation-profile/src/MapboxContainer/MapboxContainer.js"],"names":["React","useState","connect","ReactMapGL","Layer","NavigationControl","Source","update","styled","Markers","pushPinAction","setPinsAction","MAPBOX_TOKEN","process","env","REACT_APP_MAPBOX_API_KEY","mapStyle","StyledMap","div","MapboxContainer","mapHeight","pins","actions","hasPins","length","pushPin","setPins","height","width","position","longitude","latitude","zoom","viewport","setViewport","onMapClick","e","preventDefault","lngLat","onMarkerDragEnd","index","newPins","$set","onViewportChange","nextViewport","linestringGeoJSON","type","coordinates","right","mapDispatchToProps","dispatch","pin","mapStateToProps","state","submitting","chart","map"],"mappings":"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","sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport ReactMapGL, { Layer, NavigationControl, Source } from 'react-map-gl';\nimport update from 'immutability-helper';\nimport styled from 'styled-components';\nimport Markers from './Markers';\nimport { pushPinAction, setPinsAction } from '../store/actions/mapActions';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_API_KEY;\nconst mapStyle = 'mapbox://styles/pgres54268/cjuiu9aay60dx1fp784rt3x7r';\n\nconst StyledMap = styled.div`\n  transition: all 1.5s ease-in-out;\n  /* transition: transform 300ms ease-in-out; */\n`;\n\nconst MapboxContainer = ({ mapHeight, pins, actions }) => {\n  const hasPins = pins.length > 0;\n  const { pushPin, setPins } = actions;\n  const [viewport, setViewport] = useState({\n    height: mapHeight,\n    width: '100vw',\n    position: 'absolute',\n    longitude: -119,\n    latitude: 36,\n    zoom: 5,\n  });\n\n  const onMapClick = e => {\n    e.preventDefault();\n    pushPin(e.lngLat);\n  };\n\n  const onMarkerDragEnd = (e, index) => {\n    e.preventDefault();\n    const newPins = update(pins, {\n      [index]: { $set: [...e.lngLat] },\n    });\n    setPins(newPins);\n  };\n\n  const onViewportChange = nextViewport => {\n    if (viewport.longitude * nextViewport.longitude < 0) {\n      // TODO:\n      // We are moving across the antimeridian and need to\n      //   re-plot any pins near it\n      // const newPins = replotPinsNearAntimeridian(pins);\n      // console.log(pins, newPins);\n      // setPins(newPins);\n    }\n\n    setViewport({\n      ...nextViewport,\n      width: '100vw',\n    });\n  };\n\n  const linestringGeoJSON = { type: 'LineString', coordinates: [...pins] };\n  return (\n    <StyledMap>\n      <ReactMapGL\n        mapboxApiAccessToken={MAPBOX_TOKEN}\n        mapStyle={mapStyle}\n        onViewportChange={onViewportChange}\n        // onLoad={() => setLoaded(true)}\n        onClick={e => onMapClick(e)}\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        {...viewport}\n        height={mapHeight}\n      >\n        {hasPins && (\n          <>\n            <Markers pins={pins} onMarkerDragEnd={onMarkerDragEnd} />\n            <Source id=\"my-lines\" type=\"geojson\" data={linestringGeoJSON}>\n              <Layer\n                id=\"lines\"\n                type=\"line\"\n                paint={{\n                  'line-color': '#ff0000',\n                  'line-width': 2,\n                }}\n              />\n            </Source>\n          </>\n        )}\n        <div style={{ position: 'absolute', right: 0 }}>\n          <NavigationControl />\n        </div>\n      </ReactMapGL>\n    </StyledMap>\n  );\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    actions: {\n      pushPin: pin => dispatch(pushPinAction(pin)),\n      setPins: pins => dispatch(setPinsAction(pins)),\n    },\n  };\n};\n\nconst mapStateToProps = state => {\n  return {\n    submitting: state.chart.submitting,\n    pins: state.map.pins,\n    // mapHeight: state.mapHeight,\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MapboxContainer);\n"]},"metadata":{},"sourceType":"module"}