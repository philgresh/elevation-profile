{"ast":null,"code":"var _jsxFileName = \"/Users/phil/Documents/elevation-profile/src/MapboxContainer/MapboxContainer.js\";\n\n/* eslint-disable react/prop-types */\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport ReactMapGL, { Layer, NavigationControl, Source } from 'react-map-gl';\nimport update from 'immutability-helper';\nimport styled from 'styled-components';\nimport Markers from './Markers';\nimport { pushPinAction, setPinsAction } from '../store/actions/mapActions';\nimport 'mapbox-gl/dist/mapbox-gl.css';\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_API_KEY;\nconst mapStyle = 'mapbox://styles/pgres54268/cjuiu9aay60dx1fp784rt3x7r';\nconst StyledMap = styled.div`\n  transition: all 1.5s ease-in-out;\n  /* transition: transform 300ms ease-in-out; */\n`;\n\nconst MapboxContainer = ({\n  mapHeight,\n  pins,\n  actions\n}) => {\n  const hasPins = pins.length > 0;\n  const {\n    pushPin,\n    setPins\n  } = actions;\n  const [viewport, setViewport] = useState({\n    height: mapHeight,\n    width: '100vw',\n    position: 'absolute',\n    longitude: -119,\n    latitude: 36,\n    zoom: 5\n  });\n\n  const onMapClick = e => {\n    e.preventDefault();\n    pushPin(e.lngLat);\n  };\n\n  const onMarkerDragEnd = (e, index) => {\n    e.preventDefault();\n    const newPins = update(pins, {\n      [index]: {\n        $set: [...e.lngLat]\n      }\n    });\n    setPins(newPins);\n  };\n\n  const onViewportChange = nextViewport => {\n    if (viewport.longitude * nextViewport.longitude < 0) {// TODO:\n      // We are moving across the antimeridian and need to\n      //   re-plot any pins near it\n      // const newPins = replotPinsNearAntimeridian(pins);\n      // console.log(pins, newPins);\n      // setPins(newPins);\n    }\n\n    setViewport({ ...nextViewport,\n      width: '100vw'\n    });\n  };\n\n  const linestringGeoJSON = {\n    type: 'LineString',\n    coordinates: [...pins]\n  };\n  return React.createElement(StyledMap, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(ReactMapGL, Object.assign({\n    mapboxApiAccessToken: MAPBOX_TOKEN,\n    mapStyle: mapStyle,\n    onViewportChange: onViewportChange // onLoad={() => setLoaded(true)}\n    ,\n    onClick: e => onMapClick(e) // eslint-disable-next-line react/jsx-props-no-spreading\n\n  }, viewport, {\n    height: mapHeight,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), hasPins && React.createElement(React.Fragment, null, React.createElement(Markers, {\n    pins: pins,\n    onMarkerDragEnd: onMarkerDragEnd,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }), React.createElement(Source, {\n    id: \"my-lines\",\n    type: \"geojson\",\n    data: linestringGeoJSON,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, React.createElement(Layer, {\n    id: \"lines\",\n    type: \"line\",\n    paint: {\n      'line-color': '#ff0000',\n      'line-width': 2\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    style: {\n      position: 'absolute',\n      right: 0\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, React.createElement(NavigationControl, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }))));\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    actions: {\n      pushPin: pin => dispatch(pushPinAction(pin)),\n      setPins: pins => dispatch(setPinsAction(pins))\n    }\n  };\n};\n\nconst mapStateToProps = state => {\n  return {\n    submitting: state.chart.submitting,\n    pins: state.map.pins // mapHeight: state.mapHeight,\n\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MapboxContainer);","map":{"version":3,"sources":["/Users/phil/Documents/elevation-profile/src/MapboxContainer/MapboxContainer.js"],"names":["React","useState","connect","ReactMapGL","Layer","NavigationControl","Source","update","styled","Markers","pushPinAction","setPinsAction","MAPBOX_TOKEN","process","env","REACT_APP_MAPBOX_API_KEY","mapStyle","StyledMap","div","MapboxContainer","mapHeight","pins","actions","hasPins","length","pushPin","setPins","viewport","setViewport","height","width","position","longitude","latitude","zoom","onMapClick","e","preventDefault","lngLat","onMarkerDragEnd","index","newPins","$set","onViewportChange","nextViewport","linestringGeoJSON","type","coordinates","right","mapDispatchToProps","dispatch","pin","mapStateToProps","state","submitting","chart","map"],"mappings":"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","sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport ReactMapGL, { Layer, NavigationControl, Source } from 'react-map-gl';\nimport update from 'immutability-helper';\nimport styled from 'styled-components';\nimport Markers from './Markers';\nimport { pushPinAction, setPinsAction } from '../store/actions/mapActions';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_API_KEY;\nconst mapStyle = 'mapbox://styles/pgres54268/cjuiu9aay60dx1fp784rt3x7r';\n\nconst StyledMap = styled.div`\n  transition: all 1.5s ease-in-out;\n  /* transition: transform 300ms ease-in-out; */\n`;\n\nconst MapboxContainer = ({ mapHeight, pins, actions }) => {\n  const hasPins = pins.length > 0;\n  const { pushPin, setPins } = actions;\n  const [viewport, setViewport] = useState({\n    height: mapHeight,\n    width: '100vw',\n    position: 'absolute',\n    longitude: -119,\n    latitude: 36,\n    zoom: 5,\n  });\n\n  const onMapClick = e => {\n    e.preventDefault();\n    pushPin(e.lngLat);\n  };\n\n  const onMarkerDragEnd = (e, index) => {\n    e.preventDefault();\n    const newPins = update(pins, {\n      [index]: { $set: [...e.lngLat] },\n    });\n    setPins(newPins);\n  };\n\n  const onViewportChange = nextViewport => {\n    if (viewport.longitude * nextViewport.longitude < 0) {\n      // TODO:\n      // We are moving across the antimeridian and need to\n      //   re-plot any pins near it\n      // const newPins = replotPinsNearAntimeridian(pins);\n      // console.log(pins, newPins);\n      // setPins(newPins);\n    }\n\n    setViewport({\n      ...nextViewport,\n      width: '100vw',\n    });\n  };\n\n  const linestringGeoJSON = { type: 'LineString', coordinates: [...pins] };\n  return (\n    <StyledMap>\n      <ReactMapGL\n        mapboxApiAccessToken={MAPBOX_TOKEN}\n        mapStyle={mapStyle}\n        onViewportChange={onViewportChange}\n        // onLoad={() => setLoaded(true)}\n        onClick={e => onMapClick(e)}\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        {...viewport}\n        height={mapHeight}\n      >\n        {hasPins && (\n          <>\n            <Markers pins={pins} onMarkerDragEnd={onMarkerDragEnd} />\n            <Source id=\"my-lines\" type=\"geojson\" data={linestringGeoJSON}>\n              <Layer\n                id=\"lines\"\n                type=\"line\"\n                paint={{\n                  'line-color': '#ff0000',\n                  'line-width': 2,\n                }}\n              />\n            </Source>\n          </>\n        )}\n        <div style={{ position: 'absolute', right: 0 }}>\n          <NavigationControl />\n        </div>\n      </ReactMapGL>\n    </StyledMap>\n  );\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    actions: {\n      pushPin: pin => dispatch(pushPinAction(pin)),\n      setPins: pins => dispatch(setPinsAction(pins)),\n    },\n  };\n};\n\nconst mapStateToProps = state => {\n  return {\n    submitting: state.chart.submitting,\n    pins: state.map.pins,\n    // mapHeight: state.mapHeight,\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MapboxContainer);\n"]},"metadata":{},"sourceType":"module"}